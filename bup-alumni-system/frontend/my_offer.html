<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Offers | BUP Alumni Association</title>

  <!-- Global + Page CSS -->
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/my_offer.css">
</head>
<body>
  <!-- Header Include -->
  <div id="header-placeholder"></div>

  <main class="my-offers-wrapper">
    <div class="container">
      <!-- Page Header -->
      <div class="page-header">
        <h1>My Mentorship Offers</h1>
        <p class="page-subtitle">View and manage all your posted mentorship opportunities.</p>
      </div>

      <!-- Summary Cards -->
      <section class="analytics-section">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">üìã</div>
            <div class="stat-content">
              <h3 class="stat-number">6</h3>
              <p>Total Offers</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">‚úÖ</div>
            <div class="stat-content">
              <h3 class="stat-number">5</h3>
              <p>Active Offers</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">‚è∏Ô∏è</div>
            <div class="stat-content">
              <h3 class="stat-number">3</h3>
              <p>Closed Offers</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üë•</div>
            <div class="stat-content">
              <h3 class="stat-number">42</h3>
              <p>Total Applicants</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Offers List -->
      <section class="offers-section">
        <div class="section-header">
          <h2>Your Mentorship Offers</h2>
          <a href="create_offer.html" class="btn-primary">Create New Offer</a>
        </div>
        <div class="offers-grid">
          <!-- Offer Card 1 -->
          <div class="offer-card">
            <div class="offer-header">
              <h3 class="offer-title">Career Guidance in Data Science</h3>
              <span class="offer-status active">Active</span>
            </div>
            <p class="offer-category">Technology</p>
            <p class="offer-description">Providing guidance for students interested in data science careers, including machine learning and analytics.</p>
            <div class="offer-meta">
              <span class="applicants">Applicants: 10</span>
              <span class="date">Created: 2024-01-15</span>
            </div>
            <div class="offer-actions">
              <a href="applications.html" class="btn-secondary">View Applicants</a>
              <button class="btn-primary edit-btn" data-offer-id="1">Edit Offer</button>
            </div>
          </div>

          <!-- Offer Card 2 -->
          <div class="offer-card">
            <div class="offer-header">
              <h3 class="offer-title">Leadership and Communication</h3>
              <span class="offer-status closed">Closed</span>
            </div>
            <p class="offer-category">Personal Development</p>
            <p class="offer-description">Developing leadership skills and effective communication strategies for professional growth.</p>
            <div class="offer-meta">
              <span class="applicants">Applicants: 7</span>
              <span class="date">Created: 2024-01-10</span>
            </div>
            <div class="offer-actions">
              <a href="applications.html" class="btn-secondary">View Applicants</a>
              <button class="btn-primary edit-btn" data-offer-id="2">Edit Offer</button>
            </div>
          </div>

          <!-- Offer Card 3 -->
          <div class="offer-card">
            <div class="offer-header">
              <h3 class="offer-title">Business Strategy Mentorship</h3>
              <span class="offer-status active">Active</span>
            </div>
            <p class="offer-category">Business</p>
            <p class="offer-description">Strategic business planning and entrepreneurial guidance for aspiring business professionals.</p>
            <div class="offer-meta">
              <span class="applicants">Applicants: 15</span>
              <span class="date">Created: 2024-01-08</span>
            </div>
            <div class="offer-actions">
              <a href="applications.html" class="btn-secondary">View Applicants</a>
              <button class="btn-primary edit-btn" data-offer-id="3">Edit Offer</button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Edit Offer Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Edit Mentorship Offer</h2>
        <span class="close-modal">&times;</span>
      </div>
      <form id="editOfferForm">
        <input type="hidden" id="editOfferId">
        
        <div class="form-group">
          <label for="editTitle">Offer Title</label>
          <input type="text" id="editTitle" required>
        </div>
        
        <div class="form-group">
          <label for="editCategory">Category</label>
          <select id="editCategory" required>
            <option value="">Select Category</option>
            <option value="Technology">Technology</option>
            <option value="Business">Business</option>
            <option value="Personal Development">Personal Development</option>
            <option value="Healthcare">Healthcare</option>
            <option value="Education">Education</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="editStatus">Status</label>
          <select id="editStatus" required>
            <option value="active">Active</option>
            <option value="closed">Closed</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="editApplicants">Number of Applicants</label>
          <input type="number" id="editApplicants" min="0" required>
        </div>
        
        <div class="form-group">
          <label for="editDescription">Description</label>
          <textarea id="editDescription" rows="4" required></textarea>
        </div>
        
        <div class="modal-buttons">
          <button type="button" class="btn-cancel">Cancel</button>
          <button type="submit" class="btn-save">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Footer Include -->
  <div id="footer-placeholder"></div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Load header and footer
      fetch('../includes/header.html')
        .then(res => res.text())
        .then(data => document.getElementById('header-placeholder').innerHTML = data)
        .catch(err => console.error('Header load error:', err));

      fetch('../includes/footer.html')
        .then(res => res.text())
        .then(data => document.getElementById('footer-placeholder').innerHTML = data)
        .catch(err => console.error('Footer load error:', err));

      // Modal functionality
      const modal = document.getElementById('editModal');
      const editButtons = document.querySelectorAll('.edit-btn');
      const closeModal = document.querySelector('.close-modal');
      const cancelBtn = document.querySelector('.btn-cancel');
      const editForm = document.getElementById('editOfferForm');

      // Open modal
      editButtons.forEach(button => {
        button.addEventListener('click', function() {
          const offerId = this.getAttribute('data-offer-id');
          const offerCard = this.closest('.offer-card');
          const title = offerCard.querySelector('.offer-title').textContent;
          const category = offerCard.querySelector('.offer-category').textContent;
          const status = offerCard.querySelector('.offer-status').classList.contains('active') ? 'active' : 'closed';
          const applicants = offerCard.querySelector('.applicants').textContent.replace('Applicants: ', '');
          const description = offerCard.querySelector('.offer-description').textContent;

          document.getElementById('editOfferId').value = offerId;
          document.getElementById('editTitle').value = title;
          document.getElementById('editCategory').value = category;
          document.getElementById('editStatus').value = status;
          document.getElementById('editApplicants').value = applicants;
          document.getElementById('editDescription').value = description;

          modal.style.display = 'flex';
        });
      });

      // Close modal
      function closeModalFunc() {
        modal.style.display = 'none';
      }

      closeModal.addEventListener('click', closeModalFunc);
      cancelBtn.addEventListener('click', closeModalFunc);

      // Close modal when clicking outside
      window.addEventListener('click', (e) => {
        if (e.target === modal) {
          closeModalFunc();
        }
      });

      // Handle form submission
      editForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        const offerId = document.getElementById('editOfferId').value;
        const title = document.getElementById('editTitle').value;
        const category = document.getElementById('editCategory').value;
        const status = document.getElementById('editStatus').value;
        const applicants = document.getElementById('editApplicants').value;
        const description = document.getElementById('editDescription').value;
        
        // Update the offer card
        const offerCard = document.querySelector(`.edit-btn[data-offer-id="${offerId}"]`).closest('.offer-card');
        offerCard.querySelector('.offer-title').textContent = title;
        offerCard.querySelector('.offer-category').textContent = category;
        offerCard.querySelector('.applicants').textContent = `Applicants: ${applicants}`;
        offerCard.querySelector('.offer-description').textContent = description;
        
        // Update status badge
        const statusBadge = offerCard.querySelector('.offer-status');
        statusBadge.textContent = status.charAt(0).toUpperCase() + status.slice(1);
        statusBadge.className = 'offer-status';
        statusBadge.classList.add(status);
        
        closeModalFunc();
        alert('Offer updated successfully!');
      });
    });
  </script>
</body>
</html>